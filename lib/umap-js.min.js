!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var o in r)("object"==typeof exports?exports:t)[o]=r[o]}}(window,(function(){return function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function n(t,e){return Math.floor(e()*t)}function s(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function i(t){return s(t).map((function(t,e){return e}))}function h(t,e){return s(t).map((function(){return e}))}function u(t){return h(t,0)}function a(t){return t.reduce((function(t,e){return t+e}))}Object.defineProperty(e,"__esModule",{value:!0}),e.argsort=e.reshape2d=e.rejectionSample=e.max2d=e.max=e.mean=e.sum=e.linear=e.ones=e.zeros=e.filled=e.range=e.empty=e.norm=e.tauRand=e.tauRandInt=void 0,e.tauRandInt=n,e.tauRand=function(t){return t()},e.norm=function(t){var e,r,n=0;try{for(var s=o(t),i=s.next();!i.done;i=s.next()){var h=i.value;n+=Math.pow(h,2)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return Math.sqrt(n)},e.empty=s,e.range=i,e.filled=h,e.zeros=u,e.ones=function(t){return h(t,1)},e.linear=function(t,e,r){return s(r).map((function(o,n){return t+n*((e-t)/(r-1))}))},e.sum=a,e.mean=function(t){return a(t)/t.length},e.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},e.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var o=0;o<t[r].length;o++)e=t[r][o]>e?t[r][o]:e;return e},e.rejectionSample=function(t,e,r){for(var o=u(t),s=0;s<t;s++)for(var i=!0;i;){for(var h=n(e,r),a=!1,l=0;l<s;l++)if(h===o[l]){a=!0;break}a||(i=!1),o[s]=h}return o},e.reshape2d=function(t,e,r){var o=[],n=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var s=0;s<e;s++){for(var i=[],h=0;h<r;h++)i.push(t[n]),n+=1;o.push(i),1}return o},e.argsort=function(t){var e=i(t.length);return e.sort((function(e,r){return t[e]-t[r]})),e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r(2);Object.defineProperty(e,"UMAP",{enumerable:!0,get:function(){return o.UMAP}})},function(t,e,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&o(e,t,r);return n(e,t),e},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,s=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=s.next()).done;)i.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},h=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.findABParams=e.UMAP=void 0;var a=s(r(3)),l=s(r(0)),f=u(r(4)),c=function(){function t(t){var e=this;void 0===t&&(t={}),this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.c=0,this.isInitialized=!1,this.embedding=[],this.optimizationState=new m;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();this.X=t,this.knnIndices||this.knnDistances||(this.knnIndices=this.fastKnnIndices(t,this.nNeighbors),this.knnDistances=this.knnIndices.map((function(e,r){return e.map((function(e){return t[r][e]}))}))),this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio);var e=this.initializeSimplicialSetEmbedding(),r=e.head,o=e.tail,n=e.epochsPerSample;return this.optimizationState.head=r,this.optimizationState.tail=o,this.optimizationState.epochsPerSample=n,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.fastKnnIndices=function(t,e){for(var r=Array.from({length:t.length},(function(){return[]})),o=0;o<t.length;o++)r[o]=l.argsort(t[o]).slice(0,e);return r},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var o=this.knnIndices,n=void 0===o?[]:o,s=this.knnDistances,i=void 0===s?[]:s,h=this.localConnectivity,u=this.smoothKNNDistance(i,e,h),l=u.sigmas,f=u.rhos,c=this.computeMembershipStrengths(n,i,l,f),m=c.rows,p=c.cols,g=c.vals,w=[t.length,t.length],d=new a.SparseMatrix(m,p,g,w),y=a.transpose(d),b=a.pairwiseMultiply(d,y),v=a.subtract(a.add(d,y),b),M=a.multiplyScalar(v,r),x=a.multiplyScalar(b,1-r);return a.add(M,x)},t.prototype.smoothKNNDistance=function(t,e,r,o,n){void 0===r&&(r=1),void 0===o&&(o=64),void 0===n&&(n=1);for(var s=Math.log(e)/Math.log(2)*n,i=l.zeros(t.length),h=l.zeros(t.length),u=0;u<t.length;u++){var a=0,f=1/0,c=1,m=t[u],p=m.filter((function(t){return t>0}));if(p.length>=r){var g=Math.floor(r),w=r-g;g>0?(i[u]=p[g-1],w>1e-5&&(i[u]+=w*(p[g]-p[g-1]))):i[u]=w*p[0]}else p.length>0&&(i[u]=l.max(p));for(var d=0;d<o;d++){for(var y=0,b=1;b<t[u].length;b++){var v=t[u][b]-i[u];y+=v>0?Math.exp(-v/c):1}if(Math.abs(y-s)<1e-5)break;y>s?c=(a+(f=c))/2:(a=c,f===1/0?c*=2:c=(a+f)/2)}if(h[u]=c,i[u]>0){var M=l.mean(m);h[u]<.001*M&&(h[u]=.001*M)}else{var x=l.mean(t.map(l.mean));h[u]<.001*x&&(h[u]=.001*x)}}return{sigmas:h,rhos:i}},t.prototype.computeMembershipStrengths=function(t,e,r,o){for(var n=t.length,s=t[0].length,i=l.zeros(n*s),h=l.zeros(n*s),u=l.zeros(n*s),a=0;a<n;a++)for(var f=0;f<s;f++){var c=0;-1!==t[a][f]&&(c=t[a][f]===a?0:e[a][f]-o[a]<=0?1:Math.exp(-(e[a][f]-o[a])/r[a]),i[a*s+f]=a,h[a*s+f]=t[a][f],u[a*s+f]=c)}return{rows:i,cols:h,vals:u}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,o=this.graph.getValues(),n=0,s=0;s<o.length;s++){var i=o[s];n<o[s]&&(n=i)}var h=this.graph.map((function(t){return t<n/e?0:t}));this.embedding=l.zeros(h.nRows).map((function(){return l.zeros(r).map((function(){return 20*l.tauRand(t.random)-10}))}));var u=[],a=[],f=[],c=h.getAll();for(s=0;s<c.length;s++){var m=c[s];m.value&&(u.push(m.value),f.push(m.row),a.push(m.col))}return{head:a,tail:f,epochsPerSample:this.makeEpochsPerSample(u,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=l.filled(t.length,-1),o=l.max(t),n=t.map((function(t){return t/o*e}));return n.forEach((function(t,o){t>0&&(r[o]=e/n[o])})),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this.repulsionStrength,e=this.learningRate,r=this.negativeSampleRate,o=this.optimizationState.epochsPerSample,n=this.embedding[0].length,s=this.embedding.length==this.embedding.length,i=o.map((function(t){return t/r})),u=h(i),a=h(o);this.assignOptimizationStateParameters({epochOfNextSample:a,epochOfNextNegativeSample:u,epochsPerNegativeSample:i,moveOther:s,initialAlpha:e,alpha:e,gamma:t,dim:n})},t.prototype.initializeOptimization=function(){var t=this.optimizationState,e=t.head,r=t.tail,o=t.epochsPerSample,n=this.getNEpochs(),s=this.graph.nCols,i=w(this.spread,this.minDist),h=i.a,u=i.b;this.assignOptimizationStateParameters({head:e,tail:r,epochsPerSample:o,a:h,b:u,nEpochs:n,nVertices:s})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,o=e.tail,n=e.epochsPerSample,s=e.epochOfNextSample,i=e.epochOfNextNegativeSample,h=e.epochsPerNegativeSample,u=e.moveOther,a=e.initialAlpha,f=e.alpha,c=e.gamma,m=e.a,w=e.b,d=e.dim,y=e.nEpochs,b=e.nVertices,v=0;v<n.length;v++)if(!(s[v]>t)){var M=r[v],x=o[v],S=this.embedding[M],E=this.embedding[x],R=g(S,E),A=0;R>0&&(A=-2*m*w*Math.pow(R,w-1),A/=m*Math.pow(R,w)+1);for(var N=0;N<d;N++){var k=p(A*(S[N]-E[N]),4);S[N]+=k*f,u&&(E[N]+=-k*f)}s[v]+=n[v];for(var z=Math.floor((t-i[v])/h[v]),j=0;j<z;j++){this.c+=1;var T=l.tauRandInt(b,this.random),C=this.embedding[T],I=g(S,C),O=0;if(I>0)O=2*c*w,O/=(.001+I)*(m*Math.pow(I,w)+1);else if(M===T)continue;for(N=0;N<d;N++){k=4;O>0&&(k=p(O*(S[N]-C[N]),4)),S[N]+=k*f}}i[v]+=z*h[v]}return e.alpha=a*(1-t/y),e.currentEpoch+=1,this.embedding},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var o=this.optimizationState,n=o.nEpochs,s=o.currentEpoch;r=this.optimizeLayoutStep(s);var i=this.optimizationState.currentEpoch,h=!1===t(i);e=i===n||h}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();e.UMAP=c;var m=function(){this.currentEpoch=0,this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function p(t,e){return t>e?e:t<-e?-e:t}function g(t,e){for(var r=0,o=0;o<t.length;o++)r+=Math.pow(t[o]-e[o],2);return r}function w(t,e){var r=l.linear(0,3*t,300).map((function(t){return t<e?1:t})),o=l.zeros(r.length).map((function(o,n){return r[n]>=e?Math.exp(-(r[n]-e)/t):o})),n={x:r,y:o},s={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},h=f.default(n,(function(t){var e=i(t,2),r=e[0],o=e[1];return function(t){return 1/(1+r*Math.pow(t,2*o))}}),s).parameterValues,u=i(h,2);return{a:u[0],b:u[1]}}e.findABParams=w},function(t,e,r){"use strict";var o,n=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return s(e,t),e},h=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,s=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=s.next()).done;)i.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.getCSR=e.normalize=e.eliminateZeros=e.multiplyScalar=e.maximum=e.subtract=e.add=e.pairwiseMultiply=e.identity=e.transpose=e.SparseMatrix=void 0;var a=i(r(0)),l=function(){function t(t,e,r,o){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=o[0],this.nCols=o[1];for(var n=0;n<r.length;n++){var s=t[n],i=e[n];this.checkDims(s,i);var h=this.makeKey(s,i);this.entries.set(h,{value:r[n],row:s,col:i})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var o=this.makeKey(t,e);this.entries.has(o)?this.entries.get(o).value=r:this.entries.set(o,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var o=this.makeKey(t,e);return this.entries.has(o)?this.entries.get(o).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach((function(t){e.push(t)})),t&&e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row})),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,(function(t){var e=h(t,2);e[0];return e[1].row}))},t.prototype.getCols=function(){return Array.from(this.entries,(function(t){var e=h(t,2);e[0];return e[1].col}))},t.prototype.getValues=function(){return Array.from(this.entries,(function(t){var e=h(t,2);e[0];return e[1].value}))},t.prototype.forEach=function(t){this.entries.forEach((function(e){return t(e.value,e.row,e.col)}))},t.prototype.map=function(e){var r=[];this.entries.forEach((function(t){r.push(e(t.value,t.row,t.col))}));var o=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,o)},t.prototype.toArray=function(){var t=this,e=a.empty(this.nRows).map((function(){return a.zeros(t.nCols)}));return this.entries.forEach((function(t){e[t.row][t.col]=t.value})),e},t}();e.SparseMatrix=l,e.transpose=function(t){var e=[],r=[],o=[];t.forEach((function(t,n,s){e.push(n),r.push(s),o.push(t)}));var n=[t.nCols,t.nRows];return new l(r,e,o,n)},e.identity=function(t){for(var e=h(t,1)[0],r=new l([],[],[],t),o=0;o<e;o++)r.set(o,o,1);return r},e.pairwiseMultiply=function(t,e){return c(t,e,(function(t,e){return t*e}))},e.add=function(t,e){return c(t,e,(function(t,e){return t+e}))},e.subtract=function(t,e){return c(t,e,(function(t,e){return t-e}))},e.maximum=function(t,e){return c(t,e,(function(t,e){return t>e?t:e}))},e.multiplyScalar=function(t,e){return t.map((function(t){return t*e}))},e.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),o=t.getRows(),n=t.getCols(),s=0;s<r.length;s++)0===r[s]&&e.add(s);var i=function(t,r){return!e.has(r)},h=r.filter(i),u=o.filter(i),a=n.filter(i);return new l(u,a,h,t.getDims())},e.normalize=function(t,e){var r,o;void 0===e&&(e="l2");var n=f[e],s=new Map;t.forEach((function(t,e,r){var o=s.get(e)||[];o.push(r),s.set(e,o)}));var i=new l([],[],[],t.getDims()),h=function(e){for(var r=s.get(e).sort(),o=r.map((function(r){return t.get(e,r)})),h=n(o),u=0;u<h.length;u++)i.set(e,r[u],h[u])};try{for(var a=u(s.keys()),c=a.next();!c.done;c=a.next()){h(c.value)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i};var f=((o={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map((function(t){return t/e}))},o.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map((function(t){return t/e}))},o.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map((function(t){return Math.sqrt(Math.pow(t,2)/e)}))},o);function c(t,e,r){for(var o=new Set,n=[],s=[],i=[],h=function(o,h){n.push(o),s.push(h);var u=r(t.get(o,h),e.get(o,h));i.push(u)},u=t.getValues(),a=t.getRows(),f=t.getCols(),c=0;c<u.length;c++){var m=(d=a[c])+":"+(y=f[c]);o.add(m),h(d,y)}var p=e.getValues(),g=e.getRows(),w=e.getCols();for(c=0;c<p.length;c++){var d,y;m=(d=g[c])+":"+(y=w[c]);o.has(m)||h(d,y)}var b=[t.nRows,t.nCols];return new l(n,s,i,b)}e.getCSR=function(t){var e=[];t.forEach((function(t,r,o){e.push({value:t,row:r,col:o})})),e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}));for(var r=[],o=[],n=[],s=-1,i=0;i<e.length;i++){var h=e[i],u=h.row,a=h.col,l=h.value;u!==s&&(s=u,n.push(i)),r.push(a),o.push(l)}return{indices:r,values:o,indptr:n}}},function(t,e,r){"use strict";r.r(e);const o=Object.prototype.toString;function n(t){return o.call(t).endsWith("Array]")}function s(t,e,r){let o=0;const n=r(e);for(let e=0;e<t.x.length;e++)o+=Math.abs(t.y[e]-n(t.x[e]));return o}const i=Object.prototype.toString;function h(t){return i.call(t).endsWith("Array]")}const u=Object.prototype.toString;function a(t){return u.call(t).endsWith("Array]")}var l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,o=void 0===r?0:r,n=e.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=t[o],h=o+1;h<s;h++)t[h]>i&&(i=t[h]);return i};const f=Object.prototype.toString;function c(t){return f.call(t).endsWith("Array]")}var m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!c(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,o=void 0===r?0:r,n=e.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=t[o],h=o+1;h<s;h++)t[h]<i&&(i=t[h]);return i};var p=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!h(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!h(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var o=m(t),n=l(t);if(o===n)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=r.min,i=void 0===s?r.autoMinMax?o:0:s,u=r.max,a=void 0===u?r.autoMinMax?n:1:u;if(i>=a)throw new RangeError("min option must be smaller than max option");for(var f=(a-i)/(n-o),c=0;c<t.length;c++)e[c]=(t[c]-o)*f+i;return e};const g=" ".repeat(2),w=" ".repeat(4);function d(t,e={}){const{maxRows:r=15,maxColumns:o=10,maxNumSize:n=8}=e;return`${t.constructor.name} {\n${g}[\n${w}${function(t,e,r,o){const{rows:n,columns:s}=t,i=Math.min(n,e),h=Math.min(s,r),u=[];for(let e=0;e<i;e++){let r=[];for(let n=0;n<h;n++)r.push(y(t.get(e,n),o));u.push(""+r.join(" "))}h!==s&&(u[u.length-1]+=` ... ${s-r} more columns`);i!==n&&u.push(`... ${n-e} more rows`);return u.join("\n"+w)}(t,r,o,n)}\n${g}]\n${g}rows: ${t.rows}\n${g}columns: ${t.columns}\n}`}function y(t,e){const r=String(t);if(r.length<=e)return r.padEnd(e," ");const o=t.toPrecision(e-2);if(o.length<=e)return o;const n=t.toExponential(e-2),s=n.indexOf("e"),i=n.slice(s);return n.slice(0,e-i.length)+i}function b(t,e,r){let o=r?t.rows:t.rows-1;if(e<0||e>o)throw new RangeError("Row index out of range")}function v(t,e,r){let o=r?t.columns:t.columns-1;if(e<0||e>o)throw new RangeError("Column index out of range")}function M(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function x(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function S(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function E(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function R(t,e,r,o,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(N("startRow",e),N("endRow",r),N("startColumn",o),N("endColumn",n),e>r||o>n||e<0||e>=t.rows||r<0||r>=t.rows||o<0||o>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function A(t,e=0){let r=[];for(let o=0;o<t;o++)r.push(e);return r}function N(t,e){if("number"!=typeof e)throw new TypeError(t+" must be a number")}function k(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class z{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let o=new T(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)o.set(n,t,r[n*e+t]);return o}static rowVector(t){let e=new T(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new T(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new T(t,e)}static ones(t,e){return new T(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:o=Math.random}=r;let n=new T(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)n.set(r,t,o());return n}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:o=0,max:n=1e3,random:s=Math.random}=r;if(!Number.isInteger(o))throw new TypeError("min must be an integer");if(!Number.isInteger(n))throw new TypeError("max must be an integer");if(o>=n)throw new RangeError("min must be smaller than max");let i=n-o,h=new T(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=o+Math.round(s()*i);h.set(r,t,e)}return h}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let o=Math.min(t,e),n=this.zeros(t,e);for(let t=0;t<o;t++)n.set(t,t,r);return n}static diag(t,e,r){let o=t.length;void 0===e&&(e=o),void 0===r&&(r=e);let n=Math.min(o,e,r),s=this.zeros(e,r);for(let e=0;e<n;e++)s.set(e,e,t[e]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,n=new T(r,o);for(let s=0;s<r;s++)for(let r=0;r<o;r++)n.set(s,r,Math.min(t.get(s,r),e.get(s,r)));return n}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,n=new this(r,o);for(let s=0;s<r;s++)for(let r=0;r<o;r++)n.set(s,r,Math.max(t.get(s,r),e.get(s,r)));return n}static checkMatrix(t){return z.isMatrix(t)?t:new T(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,o=!0,n=!1;for(;t<this.rows&&o;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(o=!1,n=!0);t++}return o}isReducedEchelonForm(){let t=0,e=0,r=-1,o=!0,n=!1;for(;t<this.rows&&o;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(o=!1,n=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(o=!1);t++}return o}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let o=e;for(let n=e;n<t.rows;n++)t.get(n,r)>t.get(o,r)&&(o=n);if(0===t.get(o,r))r++;else{t.swapRows(e,o);let n=t.get(e,r);for(let o=r;o<t.columns;o++)t.set(e,o,t.get(e,o)/n);for(let o=e+1;o<t.rows;o++){let n=t.get(o,r)/t.get(e,r);t.set(o,r,0);for(let s=r+1;s<t.columns;s++)t.set(o,s,t.get(o,s)-t.get(e,s)*n)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,o=r-1;for(;o>=0;)if(0===t.maxRow(o))o--;else{let n=0,s=!1;for(;n<r&&!1===s;)1===t.get(o,n)?s=!0:n++;for(let r=0;r<o;r++){let s=t.get(r,n);for(let i=n;i<e;i++){let e=t.get(r,i)-s*t.get(o,i);t.set(r,i,e)}}o--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let o=new T(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)o.setSubMatrix(this,this.rows*t,this.columns*e);return o}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){b(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return T.rowVector(this.getRow(t))}setRow(t,e){b(this,t),e=M(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){b(this,t),b(this,e);for(let r=0;r<this.columns;r++){let o=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,o)}return this}getColumn(t){v(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return T.columnVector(this.getColumn(t))}setColumn(t,e){v(this,t),e=x(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){v(this,t),v(this,e);for(let r=0;r<this.rows;r++){let o=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,o)}return this}addRowVector(t){t=M(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=M(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=M(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=M(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=x(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){b(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){v(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){if(this.isEmpty())return NaN;let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){k(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)>t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}min(){if(this.isEmpty())return NaN;let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){k(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)<t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}maxRow(t){if(b(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){b(this,t),k(this);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)>e&&(e=this.get(t,o),r[1]=o);return r}minRow(t){if(b(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){b(this,t),k(this);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)<e&&(e=this.get(t,o),r[1]=o);return r}maxColumn(t){if(v(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){v(this,t),k(this);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)>e&&(e=this.get(o,t),r[0]=o);return r}minColumn(t){if(v(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){v(this,t),k(this);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)<e&&(e=this.get(o,t),r[0]=o);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError("unknown norm type: "+t)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){z.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let o=0;o<e.length;o++)r+=e[o]*t[o];return r}mmul(t){t=T.checkMatrix(t);let e=this.rows,r=this.columns,o=t.columns,n=new T(e,o),s=new Float64Array(r);for(let i=0;i<o;i++){for(let e=0;e<r;e++)s[e]=t.get(e,i);for(let t=0;t<e;t++){let e=0;for(let o=0;o<r;o++)e+=this.get(t,o)*s[o];n.set(t,i,e)}}return n}strassen2x2(t){t=T.checkMatrix(t);let e=new T(2,2);const r=this.get(0,0),o=t.get(0,0),n=this.get(0,1),s=t.get(0,1),i=this.get(1,0),h=t.get(1,0),u=this.get(1,1),a=t.get(1,1),l=(r+u)*(o+a),f=(i+u)*o,c=r*(s-a),m=u*(h-o),p=(r+n)*a,g=l+m-p+(n-u)*(h+a),w=c+p,d=f+m,y=l-f+c+(i-r)*(o+s);return e.set(0,0,g),e.set(0,1,w),e.set(1,0,d),e.set(1,1,y),e}strassen3x3(t){t=T.checkMatrix(t);let e=new T(3,3);const r=this.get(0,0),o=this.get(0,1),n=this.get(0,2),s=this.get(1,0),i=this.get(1,1),h=this.get(1,2),u=this.get(2,0),a=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),m=t.get(0,2),p=t.get(1,0),g=t.get(1,1),w=t.get(1,2),d=t.get(2,0),y=t.get(2,1),b=t.get(2,2),v=(r-s)*(-c+g),M=(-r+s+i)*(f-c+g),x=(s+i)*(-f+c),S=r*f,E=(-r+u+a)*(f-m+w),R=(-r+u)*(m-w),A=(u+a)*(-f+m),N=(-n+a+l)*(g+d-y),k=(n-l)*(g-y),z=n*d,j=(a+l)*(-d+y),C=(-n+i+h)*(w+d-b),I=(n-h)*(w-b),O=(i+h)*(-d+b),P=S+z+o*p,_=(r+o+n-s-i-a-l)*g+M+x+S+N+z+j,V=S+E+A+(r+o+n-i-h-u-a)*w+z+C+O,q=v+i*(-f+c+p-g-w-d+b)+M+S+z+C+I,F=v+M+x+S+h*y,D=z+C+I+O+s*m,L=S+E+R+a*(-f+m+p-g-w-d+y)+N+k+z,U=N+k+z+j+u*c,$=S+E+R+A+l*b;return e.set(0,0,P),e.set(0,1,_),e.set(0,2,V),e.set(1,0,q),e.set(1,1,F),e.set(1,2,D),e.set(2,0,L),e.set(2,1,U),e.set(2,2,$),e}mmulStrassen(t){t=T.checkMatrix(t);let e=this.clone(),r=e.rows,o=e.columns,n=t.rows,s=t.columns;function i(t,e,r){let o=t.rows,n=t.columns;if(o===e&&n===r)return t;{let o=z.zeros(e,r);return o=o.setSubMatrix(t,0,0),o}}o!==n&&console.warn(`Multiplying ${r} x ${o} and ${n} x ${s} matrix: dimensions do not match.`);let h=Math.max(r,n),u=Math.max(o,s);return e=i(e,h,u),function t(e,r,o,n){if(o<=512||n<=512)return e.mmul(r);o%2==1&&n%2==1?(e=i(e,o+1,n+1),r=i(r,o+1,n+1)):o%2==1?(e=i(e,o+1,n),r=i(r,o+1,n)):n%2==1&&(e=i(e,o,n+1),r=i(r,o,n+1));let s=parseInt(e.rows/2,10),h=parseInt(e.columns/2,10),u=e.subMatrix(0,s-1,0,h-1),a=r.subMatrix(0,s-1,0,h-1),l=e.subMatrix(0,s-1,h,e.columns-1),f=r.subMatrix(0,s-1,h,r.columns-1),c=e.subMatrix(s,e.rows-1,0,h-1),m=r.subMatrix(s,r.rows-1,0,h-1),p=e.subMatrix(s,e.rows-1,h,e.columns-1),g=r.subMatrix(s,r.rows-1,h,r.columns-1),w=t(z.add(u,p),z.add(a,g),s,h),d=t(z.add(c,p),a,s,h),y=t(u,z.sub(f,g),s,h),b=t(p,z.sub(m,a),s,h),v=t(z.add(u,l),g,s,h),M=t(z.sub(c,u),z.add(a,f),s,h),x=t(z.sub(l,p),z.add(m,g),s,h),S=z.add(w,b);S.sub(v),S.add(x);let E=z.add(y,v),R=z.add(d,b),A=z.sub(w,d);A.add(y),A.add(M);let N=z.zeros(2*S.rows,2*S.columns);return N=N.setSubMatrix(S,0,0),N=N.setSubMatrix(E,S.rows,0),N=N.setSubMatrix(R,0,S.columns),N=N.setSubMatrix(A,S.rows,S.columns),N.subMatrix(0,o-1,0,n-1)}(e,t=i(t,h,u),h,u)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let o=new T(this.rows,this.columns);for(let t=0;t<this.rows;t++){const n=this.getRow(t);n.length>0&&p(n,{min:e,max:r,output:n}),o.setRow(t,n)}return o}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let o=new T(this.rows,this.columns);for(let t=0;t<this.columns;t++){const n=this.getColumn(t);n.length&&p(n,{min:e,max:r,output:n}),o.setColumn(t,n)}return o}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),o=this.get(e,this.columns-1-r);this.set(e,r,o),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),o=this.get(this.rows-1-r,e);this.set(r,e,o),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=T.checkMatrix(t);let e=this.rows,r=this.columns,o=t.rows,n=t.columns,s=new T(e*o,r*n);for(let i=0;i<e;i++)for(let e=0;e<r;e++)for(let r=0;r<o;r++)for(let h=0;h<n;h++)s.set(o*i+r,n*e+h,this.get(i,e)*t.get(r,h));return s}kroneckerSum(t){if(t=T.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,o=this.kroneckerProduct(T.eye(r,r)),n=T.eye(e,e).kroneckerProduct(t);return o.add(n)}transpose(){let t=new T(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=j){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=j){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,o){R(this,t,e,r,o);let n=new T(e-t+1,o-r+1);for(let s=t;s<=e;s++)for(let e=r;e<=o;e++)n.set(s-t,e-r,this.get(s,e));return n}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let o=new T(t.length,r-e+1);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.rows)throw new RangeError("Row index out of range: "+t[n]);o.set(n,s-e,this.get(t[n],s))}return o}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let o=new T(r-e+1,t.length);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.columns)throw new RangeError("Column index out of range: "+t[n]);o.set(s-e,n,this.get(s,t[n]))}return o}setSubMatrix(t,e,r){if((t=T.checkMatrix(t)).isEmpty())return this;R(this,e,e+t.rows-1,r,r+t.columns-1);for(let o=0;o<t.rows;o++)for(let n=0;n<t.columns;n++)this.set(e+o,r+n,t.get(o,n));return this}selection(t,e){let r=function(t,e,r){return{row:S(t,e),column:E(t,r)}}(this,t,e),o=new T(t.length,e.length);for(let t=0;t<r.row.length;t++){let e=r.row[t];for(let n=0;n<r.column.length;n++){let s=r.column[n];o.set(t,n,this.get(e,s))}}return o}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new T(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=A(t.rows);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]+=t.get(r,o);return e}(this);case"column":return function(t){let e=A(t.columns);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]+=t.get(r,o);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e+=t.get(r,o);return e}(this);default:throw new Error("invalid option: "+t)}}product(t){switch(t){case"row":return function(t){let e=A(t.rows,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]*=t.get(r,o);return e}(this);case"column":return function(t){let e=A(t.columns,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]*=t.get(r,o);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e*=t.get(r,o);return e}(this);default:throw new Error("invalid option: "+t)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error("invalid option: "+t)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:o=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(o))throw new TypeError("mean must be an array");return function(t,e,r){const o=t.rows,n=t.columns,s=[];for(let i=0;i<o;i++){let o=0,h=0,u=0;for(let e=0;e<n;e++)u=t.get(i,e)-r[i],o+=u,h+=u*u;e?s.push((h-o*o/n)/(n-1)):s.push((h-o*o/n)/n)}return s}(this,r,o);case"column":if(!Array.isArray(o))throw new TypeError("mean must be an array");return function(t,e,r){const o=t.rows,n=t.columns,s=[];for(let i=0;i<n;i++){let n=0,h=0,u=0;for(let e=0;e<o;e++)u=t.get(e,i)-r[i],n+=u,h+=u*u;e?s.push((h-n*n/o)/(o-1)):s.push((h-n*n/o)/o)}return s}(this,r,o);case void 0:if("number"!=typeof o)throw new TypeError("mean must be a number");return function(t,e,r){const o=t.rows,n=t.columns,s=o*n;let i=0,h=0,u=0;for(let e=0;e<o;e++)for(let o=0;o<n;o++)u=t.get(e,o)-r,i+=u,h+=u*u;return e?(h-i*i/s)/(s-1):(h-i*i/s)/s}(this,r,o);default:throw new Error("invalid option: "+t)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[r])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[o])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e)}(this,r),this;default:throw new Error("invalid option: "+t)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let o=0;for(let e=0;e<t.columns;e++)o+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(o))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let o=0;for(let e=0;e<t.rows;e++)o+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(o))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[o])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let o=0;o<t.columns;o++)for(let n=0;n<t.rows;n++)r+=Math.pow(t.get(n,o),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e)}(this,r),this;default:throw new Error("invalid option: "+t)}}toString(t){return d(this,t)}}function j(t,e){return t-e}z.prototype.klass="Matrix","undefined"!=typeof Symbol&&(z.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return d(this)}),z.random=z.rand,z.randomInt=z.randInt,z.diagonal=z.diag,z.prototype.diagonal=z.prototype.diag,z.identity=z.eye,z.prototype.negate=z.prototype.neg,z.prototype.tensorProduct=z.prototype.kroneckerProduct;class T extends z{constructor(t,e){if(super(),T.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>=0){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<t;o++){if(r[o].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[o]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return b(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),b(this,t,!0),e=Float64Array.from(M(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){v(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let o=0;o<t;o++)r[o]=this.data[e][o];for(let o=t+1;o<this.columns;o++)r[o-1]=this.data[e][o];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),v(this,t,!0),e=x(this,e);for(let r=0;r<this.rows;r++){const o=new Float64Array(this.columns+1);let n=0;for(;n<t;n++)o[n]=this.data[r][n];for(o[n++]=e[r];n<this.columns+1;n++)o[n]=this.data[r][n-1];this.data[r]=o}return this.columns+=1,this}}var C,I;I=T,(C=z).prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},C.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},C.prototype.addM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},C.add=function(t,e){return new I(t).add(e)},C.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},C.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},C.prototype.subM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},C.sub=function(t,e){return new I(t).sub(e)},C.prototype.subtract=C.prototype.sub,C.prototype.subtractS=C.prototype.subS,C.prototype.subtractM=C.prototype.subM,C.subtract=C.sub,C.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},C.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},C.prototype.mulM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},C.mul=function(t,e){return new I(t).mul(e)},C.prototype.multiply=C.prototype.mul,C.prototype.multiplyS=C.prototype.mulS,C.prototype.multiplyM=C.prototype.mulM,C.multiply=C.mul,C.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},C.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},C.prototype.divM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},C.div=function(t,e){return new I(t).div(e)},C.prototype.divide=C.prototype.div,C.prototype.divideS=C.prototype.divS,C.prototype.divideM=C.prototype.divM,C.divide=C.div,C.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},C.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},C.prototype.modM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},C.mod=function(t,e){return new I(t).mod(e)},C.prototype.modulus=C.prototype.mod,C.prototype.modulusS=C.prototype.modS,C.prototype.modulusM=C.prototype.modM,C.modulus=C.mod,C.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},C.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},C.prototype.andM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},C.and=function(t,e){return new I(t).and(e)},C.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},C.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},C.prototype.orM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},C.or=function(t,e){return new I(t).or(e)},C.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},C.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},C.prototype.xorM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},C.xor=function(t,e){return new I(t).xor(e)},C.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},C.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},C.prototype.leftShiftM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},C.leftShift=function(t,e){return new I(t).leftShift(e)},C.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},C.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},C.prototype.signPropagatingRightShiftM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},C.signPropagatingRightShift=function(t,e){return new I(t).signPropagatingRightShift(e)},C.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},C.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},C.prototype.rightShiftM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},C.rightShift=function(t,e){return new I(t).rightShift(e)},C.prototype.zeroFillRightShift=C.prototype.rightShift,C.prototype.zeroFillRightShiftS=C.prototype.rightShiftS,C.prototype.zeroFillRightShiftM=C.prototype.rightShiftM,C.zeroFillRightShift=C.rightShift,C.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},C.not=function(t){return new I(t).not()},C.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},C.abs=function(t){return new I(t).abs()},C.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},C.acos=function(t){return new I(t).acos()},C.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},C.acosh=function(t){return new I(t).acosh()},C.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},C.asin=function(t){return new I(t).asin()},C.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},C.asinh=function(t){return new I(t).asinh()},C.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},C.atan=function(t){return new I(t).atan()},C.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},C.atanh=function(t){return new I(t).atanh()},C.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},C.cbrt=function(t){return new I(t).cbrt()},C.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},C.ceil=function(t){return new I(t).ceil()},C.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},C.clz32=function(t){return new I(t).clz32()},C.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},C.cos=function(t){return new I(t).cos()},C.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},C.cosh=function(t){return new I(t).cosh()},C.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},C.exp=function(t){return new I(t).exp()},C.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},C.expm1=function(t){return new I(t).expm1()},C.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},C.floor=function(t){return new I(t).floor()},C.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},C.fround=function(t){return new I(t).fround()},C.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},C.log=function(t){return new I(t).log()},C.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},C.log1p=function(t){return new I(t).log1p()},C.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},C.log10=function(t){return new I(t).log10()},C.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},C.log2=function(t){return new I(t).log2()},C.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},C.round=function(t){return new I(t).round()},C.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},C.sign=function(t){return new I(t).sign()},C.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},C.sin=function(t){return new I(t).sin()},C.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},C.sinh=function(t){return new I(t).sinh()},C.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},C.sqrt=function(t){return new I(t).sqrt()},C.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},C.tan=function(t){return new I(t).tan()},C.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},C.tanh=function(t){return new I(t).tanh()},C.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},C.trunc=function(t){return new I(t).trunc()},C.pow=function(t,e){return new I(t).pow(e)},C.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},C.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},C.prototype.powM=function(t){if(t=I.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};class O extends z{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class P{constructor(t){let e,r,o,n,s,i,h,u,a,l=(t=O.checkMatrix(t)).clone(),f=l.rows,c=l.columns,m=new Float64Array(f),p=1;for(e=0;e<f;e++)m[e]=e;for(u=new Float64Array(f),r=0;r<c;r++){for(e=0;e<f;e++)u[e]=l.get(e,r);for(e=0;e<f;e++){for(a=Math.min(e,r),s=0,o=0;o<a;o++)s+=l.get(e,o)*u[o];u[e]-=s,l.set(e,r,u[e])}for(n=r,e=r+1;e<f;e++)Math.abs(u[e])>Math.abs(u[n])&&(n=e);if(n!==r){for(o=0;o<c;o++)i=l.get(n,o),l.set(n,o,l.get(r,o)),l.set(r,o,i);h=m[n],m[n]=m[r],m[r]=h,p=-p}if(r<f&&0!==l.get(r,r))for(e=r+1;e<f;e++)l.set(e,r,l.get(e,r)/l.get(r,r))}this.LU=l,this.pivotVector=m,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=T.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,o,n,s=t.columns,i=t.subMatrixRow(this.pivotVector,0,s-1),h=e.columns;for(n=0;n<h;n++)for(r=n+1;r<h;r++)for(o=0;o<s;o++)i.set(r,o,i.get(r,o)-i.get(n,o)*e.get(r,n));for(n=h-1;n>=0;n--){for(o=0;o<s;o++)i.set(n,o,i.get(n,o)/e.get(n,n));for(r=0;r<n;r++)for(o=0;o<s;o++)i.set(r,o,i.get(r,o)-i.get(n,o)*e.get(r,n))}return i}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let o=0;o<r;o++)e*=t.get(o,o);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,o=new T(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n>e?o.set(n,e,t.get(n,e)):n===e?o.set(n,e,1):o.set(n,e,0);return o}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,o=new T(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n<=e?o.set(n,e,t.get(n,e)):o.set(n,e,0);return o}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function _(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class V{constructor(t){let e,r,o,n,s=(t=O.checkMatrix(t)).clone(),i=t.rows,h=t.columns,u=new Float64Array(h);for(o=0;o<h;o++){let t=0;for(e=o;e<i;e++)t=_(t,s.get(e,o));if(0!==t){for(s.get(o,o)<0&&(t=-t),e=o;e<i;e++)s.set(e,o,s.get(e,o)/t);for(s.set(o,o,s.get(o,o)+1),r=o+1;r<h;r++){for(n=0,e=o;e<i;e++)n+=s.get(e,o)*s.get(e,r);for(n=-n/s.get(o,o),e=o;e<i;e++)s.set(e,r,s.get(e,r)+n*s.get(e,o))}}u[o]=-t}this.QR=s,this.Rdiag=u}solve(t){t=T.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let o,n,s,i,h=t.columns,u=t.clone(),a=e.columns;for(s=0;s<a;s++)for(n=0;n<h;n++){for(i=0,o=s;o<r;o++)i+=e.get(o,s)*u.get(o,n);for(i=-i/e.get(s,s),o=s;o<r;o++)u.set(o,n,u.get(o,n)+i*e.get(o,s))}for(s=a-1;s>=0;s--){for(n=0;n<h;n++)u.set(s,n,u.get(s,n)/this.Rdiag[s]);for(o=0;o<s;o++)for(n=0;n<h;n++)u.set(o,n,u.get(o,n)-u.get(s,n)*e.get(o,s))}return u.subMatrix(0,a-1,0,h-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,o=r.columns,n=new T(o,o);for(t=0;t<o;t++)for(e=0;e<o;e++)t<e?n.set(t,e,r.get(t,e)):t===e?n.set(t,e,this.Rdiag[t]):n.set(t,e,0);return n}get orthogonalMatrix(){let t,e,r,o,n=this.QR,s=n.rows,i=n.columns,h=new T(s,i);for(r=i-1;r>=0;r--){for(t=0;t<s;t++)h.set(t,r,0);for(h.set(r,r,1),e=r;e<i;e++)if(0!==n.get(r,r)){for(o=0,t=r;t<s;t++)o+=n.get(t,r)*h.get(t,e);for(o=-o/n.get(r,r),t=r;t<s;t++)h.set(t,e,h.get(t,e)+o*n.get(t,r))}}return h}}class q{constructor(t,e={}){if((t=O.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,o=t.columns;const{computeLeftSingularVectors:n=!0,computeRightSingularVectors:s=!0,autoTranspose:i=!1}=e;let h,u=Boolean(n),a=Boolean(s),l=!1;if(r<o)if(i){h=t.transpose(),r=h.rows,o=h.columns,l=!0;let e=u;u=a,a=e}else h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else h=t.clone();let f=Math.min(r,o),c=Math.min(r+1,o),m=new Float64Array(c),p=new T(r,f),g=new T(o,o),w=new Float64Array(o),d=new Float64Array(r),y=new Float64Array(c);for(let t=0;t<c;t++)y[t]=t;let b=Math.min(r-1,o),v=Math.max(0,Math.min(o-2,r)),M=Math.max(b,v);for(let t=0;t<M;t++){if(t<b){m[t]=0;for(let e=t;e<r;e++)m[t]=_(m[t],h.get(e,t));if(0!==m[t]){h.get(t,t)<0&&(m[t]=-m[t]);for(let e=t;e<r;e++)h.set(e,t,h.get(e,t)/m[t]);h.set(t,t,h.get(t,t)+1)}m[t]=-m[t]}for(let e=t+1;e<o;e++){if(t<b&&0!==m[t]){let o=0;for(let n=t;n<r;n++)o+=h.get(n,t)*h.get(n,e);o=-o/h.get(t,t);for(let n=t;n<r;n++)h.set(n,e,h.get(n,e)+o*h.get(n,t))}w[e]=h.get(t,e)}if(u&&t<b)for(let e=t;e<r;e++)p.set(e,t,h.get(e,t));if(t<v){w[t]=0;for(let e=t+1;e<o;e++)w[t]=_(w[t],w[e]);if(0!==w[t]){w[t+1]<0&&(w[t]=0-w[t]);for(let e=t+1;e<o;e++)w[e]/=w[t];w[t+1]+=1}if(w[t]=-w[t],t+1<r&&0!==w[t]){for(let e=t+1;e<r;e++)d[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<o;r++)d[e]+=w[r]*h.get(e,r);for(let e=t+1;e<o;e++){let o=-w[e]/w[t+1];for(let n=t+1;n<r;n++)h.set(n,e,h.get(n,e)+o*d[n])}}if(a)for(let e=t+1;e<o;e++)g.set(e,t,w[e])}}let x=Math.min(o,r+1);if(b<o&&(m[b]=h.get(b,b)),r<x&&(m[x-1]=0),v+1<x&&(w[v]=h.get(v,x-1)),w[x-1]=0,u){for(let t=b;t<f;t++){for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<f;e++){let o=0;for(let n=t;n<r;n++)o+=p.get(n,t)*p.get(n,e);o=-o/p.get(t,t);for(let n=t;n<r;n++)p.set(n,e,p.get(n,e)+o*p.get(n,t))}for(let e=t;e<r;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}}if(a)for(let t=o-1;t>=0;t--){if(t<v&&0!==w[t])for(let e=t+1;e<o;e++){let r=0;for(let n=t+1;n<o;n++)r+=g.get(n,t)*g.get(n,e);r=-r/g.get(t+1,t);for(let n=t+1;n<o;n++)g.set(n,e,g.get(n,e)+r*g.get(n,t))}for(let e=0;e<o;e++)g.set(e,t,0);g.set(t,t,1)}let S=x-1,E=0,R=Number.EPSILON;for(;x>0;){let t,e;for(t=x-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+R*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(w[t])<=e||Number.isNaN(w[t])){w[t]=0;break}}if(t===x-2)e=4;else{let r;for(r=x-1;r>=t&&r!==t;r--){let e=(r!==x?Math.abs(w[r]):0)+(r!==t+1?Math.abs(w[r-1]):0);if(Math.abs(m[r])<=R*e){m[r]=0;break}}r===t?e=3:r===x-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=w[x-2];w[x-2]=0;for(let r=x-2;r>=t;r--){let n=_(m[r],e),s=m[r]/n,i=e/n;if(m[r]=n,r!==t&&(e=-i*w[r-1],w[r-1]=s*w[r-1]),a)for(let t=0;t<o;t++)n=s*g.get(t,r)+i*g.get(t,x-1),g.set(t,x-1,-i*g.get(t,r)+s*g.get(t,x-1)),g.set(t,r,n)}break}case 2:{let e=w[t-1];w[t-1]=0;for(let o=t;o<x;o++){let n=_(m[o],e),s=m[o]/n,i=e/n;if(m[o]=n,e=-i*w[o],w[o]=s*w[o],u)for(let e=0;e<r;e++)n=s*p.get(e,o)+i*p.get(e,t-1),p.set(e,t-1,-i*p.get(e,o)+s*p.get(e,t-1)),p.set(e,o,n)}break}case 3:{const e=Math.max(Math.abs(m[x-1]),Math.abs(m[x-2]),Math.abs(w[x-2]),Math.abs(m[t]),Math.abs(w[t])),n=m[x-1]/e,s=m[x-2]/e,i=w[x-2]/e,h=m[t]/e,l=w[t]/e,f=((s+n)*(s-n)+i*i)/2,c=n*i*(n*i);let d=0;0===f&&0===c||(d=f<0?0-Math.sqrt(f*f+c):Math.sqrt(f*f+c),d=c/(f+d));let y=(h+n)*(h-n)+d,b=h*l;for(let e=t;e<x-1;e++){let n=_(y,b);0===n&&(n=Number.MIN_VALUE);let s=y/n,i=b/n;if(e!==t&&(w[e-1]=n),y=s*m[e]+i*w[e],w[e]=s*w[e]-i*m[e],b=i*m[e+1],m[e+1]=s*m[e+1],a)for(let t=0;t<o;t++)n=s*g.get(t,e)+i*g.get(t,e+1),g.set(t,e+1,-i*g.get(t,e)+s*g.get(t,e+1)),g.set(t,e,n);if(n=_(y,b),0===n&&(n=Number.MIN_VALUE),s=y/n,i=b/n,m[e]=n,y=s*w[e]+i*m[e+1],m[e+1]=-i*w[e]+s*m[e+1],b=i*w[e+1],w[e+1]=s*w[e+1],u&&e<r-1)for(let t=0;t<r;t++)n=s*p.get(t,e)+i*p.get(t,e+1),p.set(t,e+1,-i*p.get(t,e)+s*p.get(t,e+1)),p.set(t,e,n)}w[x-2]=y,E+=1;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,a))for(let e=0;e<=S;e++)g.set(e,t,-g.get(e,t));for(;t<S&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,a&&t<o-1)for(let r=0;r<o;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);if(u&&t<r-1)for(let o=0;o<r;o++)e=p.get(o,t+1),p.set(o,t+1,p.get(o,t)),p.set(o,t,e);t++}E=0,x--}}if(l){let t=g;g=p,p=t}this.m=r,this.n=o,this.s=m,this.U=p,this.V=g}solve(t){let e=t,r=this.threshold,o=this.s.length,n=T.zeros(o,o);for(let t=0;t<o;t++)Math.abs(this.s[t])<=r?n.set(t,t,0):n.set(t,t,1/this.s[t]);let s=this.U,i=this.rightSingularVectors,h=i.mmul(n),u=i.rows,a=s.rows,l=T.zeros(u,a);for(let t=0;t<u;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<o;n++)r+=h.get(t,n)*s.get(e,n);l.set(t,e,r)}return l.mmul(e)}solveForDiagonal(t){return this.solve(T.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,o=t.columns,n=new T(r,this.s.length);for(let s=0;s<r;s++)for(let r=0;r<o;r++)Math.abs(this.s[r])>e&&n.set(s,r,t.get(s,r)/this.s[r]);let s=this.U,i=s.rows,h=s.columns,u=new T(r,i);for(let t=0;t<r;t++)for(let e=0;e<i;e++){let r=0;for(let o=0;o<h;o++)r+=n.get(t,o)*s.get(e,o);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let o=0,n=r.length;o<n;o++)r[o]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return T.diag(this.s)}}function F(t,e=!1){return t=O.checkMatrix(t),e?new q(t).inverse():function(t,e,r=!1){return t=O.checkMatrix(t),e=O.checkMatrix(e),r?new q(t).solve(e):t.isSquare()?new P(t).solve(e):new V(t).solve(e)}(t,T.eye(t.rows))}function D(t,e,r,o,n){let s=r*o*o,i=T.eye(e.length,e.length,s);const h=n(e);let u=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)u[e]=h(t.x[e]);let a=function(t,e,r,o,n){const s=r.length,i=t.x.length;let h=new Array(s);for(let u=0;u<s;u++){h[u]=new Array(i);let s=r.slice();s[u]+=o;let a=n(s);for(let r=0;r<i;r++)h[u][r]=e[r]-a(t.x[r])}return new T(h)}(t,u,e,o,n),l=function(t,e){const r=t.x.length;let o=new Array(r);for(let n=0;n<r;n++)o[n]=[t.y[n]-e[n]];return new T(o)}(t,u),f=F(i.add(a.mmul(a.transpose())));return(e=(e=new T([e])).sub(f.mmul(a).mmul(l).mul(o).transpose())).to1DArray()}function L(t,e,r={}){let{maxIterations:o=100,gradientDifference:i=.1,damping:h=0,errorTolerance:u=.01,minValues:a,maxValues:l,initialValues:f}=r;if(h<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!n(t.x)||t.x.length<2||!n(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let c=f||new Array(e.length).fill(1),m=c.length;if(l=l||new Array(m).fill(Number.MAX_SAFE_INTEGER),a=a||new Array(m).fill(Number.MIN_SAFE_INTEGER),l.length!==a.length)throw new Error("minValues and maxValues must be the same size");if(!n(c))throw new Error("initialValues must be an array");let p,g=s(t,c,e),w=g<=u;for(p=0;p<o&&!w;p++){c=D(t,c,h,i,e);for(let t=0;t<m;t++)c[t]=Math.min(Math.max(a[t],c[t]),l[t]);if(g=s(t,c,e),isNaN(g))break;w=g<=u}return{parameterValues:c,parameterError:g,iterations:p}}r.d(e,"default",(function(){return L}))}])}));